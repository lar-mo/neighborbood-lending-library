{% extends 'lendingLibrary/base.html' %}

{% block title %}
<title>Manage Items - Neighborhood Lending Library</title>
{% endblock %}

{% block heading %}
<h2>Manage Your Items</h2>
{% endblock %}

{% block content %}
  <div id="item_list"> <!-- start of 'item_list' -->
      <table>
        <tr>
          <th>ADD</th>
          <th>EDIT</th>
          <th>DELETE</th>
        </tr>
        <tr>
          <td style="text-align:center">
            <button style="margin:0 50px" id="btn_add_item">Add an Item</button>
          </td>
          <td style="text-align:center">
            <div>
              <form action="{% url 'lendingLibrary:edit_item' %}" method="post">
                {% csrf_token %}
                Select one of your items:<br/>
                <select name="user_item" required>
                  <option disabled selected value="">-----</option>
                {% for item in items %}
                  <option value="{{item.id}}">{{item.name}}</option>
                {% endfor %}
                </select>
                <button>Load Data</button>
              </form>
            </div>
          </td>
          <td style="text-align:center">
            <div>
              <form action="{% url 'lendingLibrary:delete_item' %}" method="post">
                {% csrf_token %}
                Select one of your items:<br/>
                <select name="user_items" id="select_user_items" required>
                  <option disabled selected value="">-----</option>
                {% for item in items %}
                  <option value="{{item.id}}">{{item.name}}</option>
                {% endfor %}
                </select>
                <button type="submit" id="btn_delete">Delete</button>
              </form>
            </div>
          </td>
        </tr>
      </table>
  </div> <!-- end of 'item_list' -->
{% endblock %}

{% block script %}
      btn_add_item = document.querySelector('#btn_add_item')
      btn_add_item.onclick = function() {
        window.location={% url 'lendingLibrary:new_item' %}
      }

      let btn_delete = document.querySelector('#btn_delete')
      let select_item_delete = document.querySelector('#select_user_items')
      btn_delete.onclick = function(event) {
        if (select_item_delete.value == '') {
          alert("You have to select an item first.")
          event.preventDefault()
        } else {
          let answer = confirm("Are you sure you want to delete \"" + select_item_delete.options[select_item_delete.selectedIndex].text + "\"?\n\nThis action cannot be undo.")
          if (!answer) {
            event.preventDefault()
          } // end of inner 'if statement'
        } // end of outer 'if statement'
      } // end of 'onclick'
{% endblock %}
